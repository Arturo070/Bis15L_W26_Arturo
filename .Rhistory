sharks %>%
summarize(sharks)
sharks
summarize(sharks)
summarize(sharks)
sharks
sharks+
summarize(sharks)
library("tidyverse")
library("janitor")
sharks <-
read_csv("data/SharkIncidents_1950_2022_220302.csv",
na=c("NA", "N/A", "Unknown", "NOT COUNTED", "", " ")) %>%
clean_names()
sharks %>%
group_by(county) %>%
summarise(incidents=sum(incident_num)) %>%
ggplot(aes(x=reorder(county, -incidents), y=incidents)) +
geom_col()+
coord_flip()+
labs(title="Incidents per County",
x="County",
y="Number Of Incidents")
sharks+
summarize(sharks)
sharks %>%
summarize(sharks)
names(sharks)
# Summarize total incidents per county
county_totals <- data %>%
count(county, name = "total_incidents")
county_totals <- data %>%
count(county, name = "total_incidents")
county_totals <- sharks %>%
count(county, name = "total_incidents")
ggplot(county_totals, aes(x = county, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents per County",
x = "County",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(county_totals, aes(x = county, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents per County",
x = "County",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 2))
ggplot(county_totals, aes(x = county, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents per County",
x = "County",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
ggplot(county_totals, aes(x = county, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents per County",
x = "County",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 01))
ggplot(county_totals, aes(x = county, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents per County",
x = "County",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
month_totals <- sharks %>%
count(month, name = "total_incidents")
sharks %>%
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
sharks %>%
ggplot(month_totals, mapping, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
sharks %>%
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
sharks %>%
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
sharks %>%
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
month_totals %>%
filter(total_incidents == max(total_incidents))
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
month_totals %>%
filter(total_incidents == max(total_incidents))
month_totals %>%
filter(total_incidents == max(total_incidents))+
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
month_totals %>%
filter(total_incidents == max(total_incidents))+
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
month_totals %>%
filter(total_incidents == max(total_incidents))
injury_table <- sharks %>%
count(county, injury) %>%
pivot_wider(
names_from = injury,
values_from = n,
values_fill = 0
)
sharks %>%
count(county, name = "total_incidents") %>%
filter(total_incidents == max(total_incidents))
time_totals <- sharks %>%
count(time, name = "total_incidents")
# Plot
ggplot(time_totals, aes(x = time, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Time of Day",
x = "Time of Day",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Time of day with the highest number of incidents
time_totals %>%
filter(total_incidents == max(total_incidents))
# Plot
ggplot(time_totals, aes(x = time, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Time of Day",
x = "Time of Day",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
sharks %>%
count(county) %>%
ggplot(aes(x = n, y = reorder(county, n))) +
geom_col(fill = "yellow") +
labs(
title = "Total Shark Incidents by County",
x = "Number of Incidents",
y = "County"
) +
theme_minimal()
sharks %>%
count(county) %>%
ggplot(aes(x = n, y = reorder(county, n))) +
geom_col(fill = "yellow","red") +
labs(
title = "Total Shark Incidents by County",
x = "Number of Incidents",
y = "County"
) +
theme_minimal()
sharks %>%
count(county) %>%
ggplot(aes(x = n, y = reorder(county, n))) +
geom_col(fill = "yellow") +
labs(
title = "Total Shark Incidents by County",
x = "Number of Incidents",
y = "County"
) +
theme_minimal()
sharks %>%
count(mode, sort = TRUE) %>%
slice(1)
sharks %>%
count(mode, sort = TRUE) %>%
slice(2)
sharks %>%
count(mode, sort = TRUE) %>%
slice(3)
sharks %>%
count(mode, sort = TRUE) %>%
slice(1)
sharks %>%
count(mode) %>%
ggplot(aes(x = n, y = reorder(mode, n))) +
geom_col(fill = "darkcyan") +
labs(
title = "Incidents by Activity (Mode)",
x = "Number of Incidents",
y = "Activity"
) +
theme_minimal()
sharks %>%
count(mode) %>%
ggplot(aes(x = n, y = reorder(mode, n))) +
geom_col(fill = "pink") +
labs(
title = "Incidents by Activity (Mode)",
x = "Number of Incidents",
y = "Activity"
) +
theme_minimal()
sharks %>%
count(mode) %>%
ggplot(aes(x = n, y = reorder(mode, n))) +
geom_col(fill = "pink") +
labs(
title = "Incidents per Activity (Mode)",
x = "Number of Incidents",
y = "Activity"
) +
theme_minimal()
sharks %>%
count(species, sort = TRUE) %>%
slice(1:5)
sharks %>%
filter(str_detect(species, "(?i)white")) %>%
ggplot(aes(x = injury, fill = injury)) +
geom_bar() +
labs(
title = "Incident Types for Great White Sharks",
x = "Injury Category",
y = "Number of Incidents"
) +
theme_minimal() +
theme(legend.position = "none")
sharks %>%
filter(str_detect(species, "(?i)white")) %>%
ggplot(aes(x = injury, fill = injury)) +
geom_bar() +
labs(
title = "Incident Types for Great White Sharks",
x = "Injury Category",
y = "Number of Incidents"
) +
theme_minimal()
month_totals <- sharks %>%
count(month, name = "total_incidents")
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
month_totals %>%
filter(total_incidents == max(total_incidents))
time_totals <- sharks %>%
count(time, name = "total_incidents")
# Plot
ggplot(time_totals, aes(x = time, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Time of Day",
x = "Time of Day",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# Time of day with the highest number of incidents
time_totals %>%
filter(total_incidents == max(total_incidents))
time_totals <- sharks %>%
count(time, name = "total_incidents")
# Plot
ggplot(time_totals, aes(x = time, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Time of Day",
x = "Time of Day",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
time_totals %>%
filter(total_incidents == max(total_incidents))
peak_time <- sharks %>%
filter(!is.na(time), time != "Unknown") %>%
count(time, name = "total_incidents") %>%
filter(total_incidents == max(total_incidents))
sharks %>%
filter(!is.na(time), time != "Unknown") %>%
count(time) %>%
slice_max(n, n = 20) %>% # Focus on the most frequent times
ggplot(aes(x = reorder(time, -n), y = n)) +
geom_col(fill = "steelblue") +
labs(
title = "Top 20 Times of Day for Shark Incidents",
x = "Time of Day",
y = "Number of Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
peak_time <- sharks %>%
filter(!is.na(time), time != "Unknown") %>%
count(time, name = "total_incidents") %>%
filter(total_incidents == max(total_incidents))
sharks %>%
filter(!is.na(time), time != "Unknown") %>%
count(time) %>%
slice_max(n, n = 20) %>%
ggplot(aes(x = reorder(time, -n), y = n)) +
geom_col(fill = "pink") +
labs(
title = "20 Best Times of Day for Shark Incidents",
x = "Time of Day",
y = "Number of Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
injury_table <- sharks %>%
count(county, injury) %>%
pivot_wider(
names_from = injury,
values_from = n,
values_fill = 0
)
sharks %>%
count(county, name = "total_incidents") %>%
filter(total_incidents == max(total_incidents))
library("tidyverse")
library("janitor")
sharks <-
read_csv("data/SharkIncidents_1950_2022_220302.csv",
na=c("NA", "N/A", "Unknown", "NOT COUNTED", "", " ")) %>%
clean_names()
sharks %>%
group_by(county) %>%
summarise(incidents=sum(incident_num)) %>%
ggplot(aes(x=reorder(county, -incidents), y=incidents)) +
geom_col()+
coord_flip()+
labs(title="Incidents per County",
x="County",
y="Number Of Incidents")
sharks %>%
summarize(sharks)
names(sharks)
county_totals <- sharks %>%
count(county, name = "total_incidents")
ggplot(county_totals, aes(x = county, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents per County",
x = "County",
y = "Total Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
month_totals <- sharks %>%
count(month, name = "total_incidents")
ggplot(month_totals, aes(x = month, y = total_incidents)) +
geom_col() +
labs(
title = "Total Number of Incidents by Month",
x = "Month",
y = "Total Incidents"
) +
theme_minimal()
month_totals %>%
filter(total_incidents == max(total_incidents))
peak_time <- sharks %>%
filter(!is.na(time), time != "Unknown") %>%
count(time, name = "total_incidents") %>%
filter(total_incidents == max(total_incidents))
sharks %>%
filter(!is.na(time), time != "Unknown") %>%
count(time) %>%
slice_max(n, n = 20) %>%
ggplot(aes(x = reorder(time, -n), y = n)) +
geom_col(fill = "pink") +
labs(
title = "20 Best Times of Day for Shark Incidents",
x = "Time of Day",
y = "Number of Incidents"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
injury_table <- sharks %>%
count(county, injury) %>%
pivot_wider(
names_from = injury,
values_from = n,
values_fill = 0
)
sharks %>%
count(county, name = "total_incidents") %>%
filter(total_incidents == max(total_incidents))
sharks %>%
count(county) %>%
ggplot(aes(x = n, y = reorder(county, n))) +
geom_col(fill = "yellow") +
labs(
title = "Total Shark Incidents by County",
x = "Number of Incidents",
y = "County"
) +
theme_minimal()
sharks %>%
count(mode, sort = TRUE) %>%
slice(1)
sharks %>%
count(mode) %>%
ggplot(aes(x = n, y = reorder(mode, n))) +
geom_col(fill = "pink") +
labs(
title = "Incidents per Activity (Mode)",
x = "Number of Incidents",
y = "Activity"
) +
theme_minimal()
sharks %>%
count(species, sort = TRUE) %>%
slice(1:5)
